<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f9f9f9;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .controls, .team-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    .controls input {
      flex: 1;
      padding: 6px;
      font-size: 16px;
    }
    .team-row {
      flex-wrap: wrap;
    }
    .team-row > * {
      margin: 2px 0;
    }
    .team-name {
      min-width: 120px;
      font-weight: bold;
    }
    .team-row input {
      width: 80px;
      padding: 4px;
      font-size: 14px;
    }
    .team-row input.logo-input {
      flex: 1;
      width: auto;
      padding: 4px 8px;
    }
    button {
      padding: 6px 12px;
      cursor: pointer;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button.delete {
      background: #f44336;
    }
    .note {
      font-size: 0.85rem;
      color: #555;
      margin-top: -6px;
      margin-bottom: 8px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: white;
    }
    th, td {
      padding: 8px;
      border: 1px solid #ccc;
      text-align: center;
    }
    th {
      background: #eee;
    }
    td input[type="number"] {
      width: 50px;
      padding: 4px;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏•</h1>

  <div class="controls">
    <input type="text" id="teamNameInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡πÉ‡∏´‡∏°‡πà" />
    <button id="addTeamBtn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏°</button>
    <button id="clearAllBtn">üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏µ‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  </div>

  <div id="teamInputsContainer"></div>

  <table id="leagueTable" style="display: none;">
    <thead>
      <tr>
        <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
        <th>‡πÇ‡∏•‡πÇ‡∏Å‡πâ</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</th>
        <th>‡∏ä‡∏ô‡∏∞</th>
        <th>‡πÄ‡∏™‡∏°‡∏≠</th>
        <th>‡πÅ‡∏û‡πâ</th>
        <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <!-- Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

  <script>
    // 1. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Firebase config (‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ñ‡∏∏‡∏ì)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://score-point-a4b6b-default-rtdb.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    // 2. ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Realtime Database
    const db = firebase.database();
    const teamsRef = db.ref("teams");

    let teams = [];

    // 3. ‡∏ü‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå + ‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    teamsRef.on("value", snapshot => {
      const data = snapshot.val() || {};
      teams = Object.keys(data).map(key => ({
        id: key,
        name: data[key].name,
        logo: data[key].logo,
        win: data[key].win,
        draw: data[key].draw,
        loss: data[key].loss
      }));

      teams.forEach((team, idx) => {
        if (!team.logo || team.logo.trim() === "") {
          const defaultLogo = `A${idx + 1}.png`;
          teamsRef.child(team.id).update({ logo: defaultLogo });
          team.logo = defaultLogo;
        }
      });

      renderTeamInputs();
      renderTable();
    });

    // 4. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏°
    async function addTeam() {
      const input = document.getElementById("teamNameInput");
      const name = input.value.trim();
      if (!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°");
      await teamsRef.push({ name, logo: "", win: 0, draw: 0, loss: 0 });
      input.value = "";
    }

    // 5. ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡∏°
    async function clearAll() {
      if (!confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) return;
      await teamsRef.remove();
    }

    // 6. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
    function handleInputChange(e) {
      const id    = e.target.dataset.id;
      const field = e.target.dataset.field;
      const val   = field === "logo"
                    ? e.target.value
                    : parseInt(e.target.value) || 0;
      teamsRef.child(id).update({ [field]: val });
    }

    // 7. ‡∏•‡∏ö‡∏ó‡∏µ‡∏°‡∏ï‡∏≤‡∏° id
    function handleDeleteTeam(e) {
      const id = e.target.dataset.id;
      // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
      if (!confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡∏µ‡∏°‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
        return;  // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‡∏Å‡πá‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
      }
      teamsRef.child(id).remove();
    }

    // 8. ‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡∏° (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÇ‡∏•‡πÇ‡∏Å‡πâ)
    function renderTeamInputs() {
      const container = document.getElementById("teamInputsContainer");
      container.innerHTML = "";

      teams.forEach(team => {
        const row = document.createElement("div");
        row.className = "team-row";
        row.innerHTML = `
          <span class="team-name">${team.name}</span>

          
          <button class="delete" data-id="${team.id}">‚ùå ‡∏•‡∏ö</button>
        `;
        container.appendChild(row);
      });

      container.querySelectorAll("input.logo-input")
        .forEach(el => el.addEventListener("input", handleInputChange));
      container.querySelectorAll("button.delete")
        .forEach(btn => btn.addEventListener("click", handleDeleteTeam));
    }

    // 9. ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏¥‡∏ô‡πÑ‡∏•‡∏ô‡πå
    function renderTable() {
      const table = document.getElementById("leagueTable");
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = "";

      if (teams.length === 0) {
        table.style.display = "none";
        return;
      }

      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
      const sorted = [...teams].sort((a, b) => {
        const pa = a.win * 3 + a.draw;
        const pb = b.win * 3 + b.draw;
        return pb - pa;
      });

      sorted.forEach((team, i) => {
        const points   = team.win * 3 + team.draw;
        const defaultLogo = `A${i + 1}.png`;
        const logoFile = team.logo && team.logo.trim() !== ""
                         ? team.logo
                         : defaultLogo;
        const logoPath = `logos/${logoFile}`;

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${i + 1}</td>
          <td>
            <img src="${logoPath}"
                 alt="${team.name}"
                 style="width:32px;height:32px;"
                 onerror="this.src='logos/${defaultLogo}'; this.onerror=null;">
          </td>
          <td>${team.name}</td>
          <td>
            <input type="number" min="0" value="${team.win}"
                   data-id="${team.id}" data-field="win" />
          </td>
          <td>
            <input type="number" min="0" value="${team.draw}"
                   data-id="${team.id}" data-field="draw" />
          </td>
          <td>
            <input type="number" min="0" value="${team.loss}"
                   data-id="${team.id}" data-field="loss" />
          </td>
          <td>${points}</td>
        `;
        tbody.appendChild(tr);

        // ‡∏ú‡∏π‡∏Å‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏≠‡∏¥‡∏ô‡πÑ‡∏•‡∏ô‡πå
        tr.querySelectorAll("input[type='number']")
          .forEach(input => input.addEventListener("input", handleInputChange));
      });

      table.style.display = "table";
    }

    // 10. ‡∏ú‡∏π‡∏Å‡∏õ‡∏∏‡πà‡∏° add / clear
    document.getElementById("addTeamBtn")
            .addEventListener("click", addTeam);
    document.getElementById("clearAllBtn")
            .addEventListener("click", clearAll);
  </script>



</body>
</html>
